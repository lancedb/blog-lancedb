<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ .Site.Title }}</title>
    <link rel="stylesheet" href="/css/custom.css">
    <script src="/js/announcement.js"></script>
    <script src="/js/category-filter.js"></script>
</head>
<body>
    {{ partial "announcement.html" . }}
    <header class="site-header">
        <div class="header-content">
            <a href="/" class="site-title">
                <img src="/assets/blog/logo.png" alt="{{ .Site.Title }}" class="site-logo">
            </a>
            <div class="header-links">
                <a href="https://lancedb.com/documentation" class="header-link">Documentation</a>
                <a href="https://lancedb.com/pricing" class="header-link">Pricing</a>
                <a href="/get-started" class="header-link get-started">Get Started</a>
            </div>
        </div>
    </header>
    <main>
        {{ $allPosts := where .Site.RegularPages "Section" "posts" }}
        {{ $featuredPosts := where $allPosts ".Params.featured" true }}
        {{ $nonFeaturedPosts := where $allPosts ".Params.featured" "ne" true }}
        
        <!-- Featured Section - Only show on first page -->
        {{ if and $featuredPosts (eq .Paginator.PageNumber 1) }}
            {{ $mainFeatured := index $featuredPosts 0 }}
            {{ $sideFeatured := after 1 $featuredPosts }}
            <div class="featured-section">
                <!-- Main Featured Post -->
                <article class="main-featured" data-categories="{{ if $mainFeatured.Params.categories }}{{ delimit $mainFeatured.Params.categories "," }}{{ else }}uncategorized{{ end }}">
                    <a href="{{ $mainFeatured.RelPermalink }}">
                        <img src="{{ $mainFeatured.Params.image | default "/assets/posts/preview.png" }}" alt="{{ $mainFeatured.Title }}" class="preview-image">
                    </a>
                    <h2><a href="{{ $mainFeatured.RelPermalink }}">{{ $mainFeatured.Title }}</a></h2>
                    <div class="post-meta">
                        {{ if $mainFeatured.Params.categories }}
                            <span class="post-category">{{ index $mainFeatured.Params.categories 0 }}</span>
                            <span class="meta-divider">•</span>
                        {{ end }}
                        <span class="post-author">{{ $mainFeatured.Params.author }}</span>
                        <span class="meta-divider">•</span>
                        <span class="post-date">{{ $mainFeatured.Date.Format "January 2, 2006" }}</span>
                    </div>
                    <p class="post-description">{{ $mainFeatured.Description | default (truncate 160 $mainFeatured.Summary) }}</p>
                </article>
                <!-- Side Featured Posts -->
                <div class="side-featured">
                    {{ range first 2 $sideFeatured }}
                        <article class="side-featured-post" data-categories="{{ if .Params.categories }}{{ delimit .Params.categories "," }}{{ else }}uncategorized{{ end }}">
                            <a href="{{ .RelPermalink }}">
                                <img src="{{ .Params.image | default "/assets/posts/preview.png" }}" alt="{{ .Title }}" class="preview-image">
                            </a>
                            <h2><a href="{{ .RelPermalink }}">{{ .Title }}</a></h2>
                            <div class="post-meta">
                                <span class="post-author">{{ .Params.author }}</span>
                                <span class="post-date">{{ .Date.Format "January 2, 2006" }}</span>
                            </div>
                        </article>
                    {{ end }}
                </div>
            </div>
        {{ end }}
        
        <!-- Category Filters -->
        <div class="category-filters">
            <button class="filter-link active" data-category="all">All Posts</button>
            {{ range .Site.Params.categories }}
                <button class="filter-link inactive" data-category="{{ .slug }}">{{ .name }}</button>
            {{ end }}
        </div>
        
        <!-- Posts Grid with Pagination -->
        <div class="post-grid">
            {{ $paginator := .Paginate $nonFeaturedPosts }}
            {{ range $paginator.Pages }}
                <article class="post-card" data-categories="{{ if .Params.categories }}{{ delimit .Params.categories "," }}{{ else }}uncategorized{{ end }}">
                    <a href="{{ .RelPermalink }}">
                        <img src="{{ .Params.image | default "/assets/posts/preview.png" }}" alt="{{ .Title }}" class="preview-image">
                    </a>
                    <h2><a href="{{ .RelPermalink }}">{{ .Title }}</a></h2>
                    <div class="post-meta">
                        {{ if .Params.categories }}
                            <span class="post-category">{{ index .Params.categories 0 }}</span>
                            <span class="meta-divider">•</span>
                        {{ end }}
                        <span class="post-author">{{ .Params.author }}</span>
                        <span class="meta-divider">•</span>
                        <span class="post-date">{{ .Date.Format "January 2, 2006" }}</span>
                    </div>
                    <p class="post-description">{{ .Description | default (truncate 100 .Summary) }}</p>
                </article>
            {{ end }}
        </div>
        
        <!-- Pagination Navigation -->
        {{ if gt $paginator.TotalPages 1 }}
        <nav class="pagination">
            <div class="pagination-info">
                <span>Page {{ $paginator.PageNumber }} of {{ $paginator.TotalPages }}</span>
                <span class="posts-count">({{ len $nonFeaturedPosts }} posts total)</span>
            </div>
            <div class="pagination-links">
                {{ if $paginator.HasPrev }}
                    <a href="{{ $paginator.Prev.URL }}" class="pagination-link prev" rel="prev">
                        <span class="pagination-arrow">←</span>
                        <span class="pagination-text">Previous</span>
                    </a>
                {{ end }}
                
                {{ $currentPage := $paginator.PageNumber }}
                {{ $totalPages := $paginator.TotalPages }}
                {{ $showRange := 2 }}
                
                <!-- First page -->
                {{ if gt $currentPage (add $showRange 2) }}
                    <a href="{{ $paginator.First.URL }}" class="pagination-link page-number">1</a>
                    {{ if gt $currentPage (add $showRange 3) }}
                        <span class="pagination-ellipsis">...</span>
                    {{ end }}
                {{ end }}
                
                <!-- Page numbers around current page -->
                {{ range $paginator.Pagers }}
                    {{ $pageNum := .PageNumber }}
                    {{ if and (ge $pageNum (sub $currentPage $showRange)) (le $pageNum (add $currentPage $showRange)) }}
                        {{ if eq $pageNum $currentPage }}
                            <span class="pagination-link current">{{ $pageNum }}</span>
                        {{ else }}
                            <a href="{{ .URL }}" class="pagination-link page-number">{{ $pageNum }}</a>
                        {{ end }}
                    {{ end }}
                {{ end }}
                
                <!-- Last page -->
                {{ if lt $currentPage (sub $totalPages (add $showRange 1)) }}
                    {{ if lt $currentPage (sub $totalPages (add $showRange 2)) }}
                        <span class="pagination-ellipsis">...</span>
                    {{ end }}
                    <a href="{{ $paginator.Last.URL }}" class="pagination-link page-number">{{ $totalPages }}</a>
                {{ end }}
                
                {{ if $paginator.HasNext }}
                    <a href="{{ $paginator.Next.URL }}" class="pagination-link next" rel="next">
                        <span class="pagination-text">Next</span>
                        <span class="pagination-arrow">→</span>
                    </a>
                {{ end }}
            </div>
        </nav>
        {{ end }}
    </main>
    {{ partial "newsletter.html" . }}
    <footer class="site-footer">
        <div class="footer-content">
            <a href="/" class="site-title">
                <img src="/assets/blog/logo.png" alt="{{ .Site.Title }}" class="site-logo">
            </a>
            <div class="footer-links">
                <a href="https://lancedb.com/documentation" class="footer-link">Documentation</a>
                <a href="https://lancedb.com/pricing" class="footer-link">Pricing</a>
                <a href="/get-started" class="footer-link get-started">Get Started</a>
            </div>
        </div>
    </footer>
</body>
</html> 