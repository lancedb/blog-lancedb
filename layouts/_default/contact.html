{{ define "body_class" }}
  contact-page
{{ end }}
{{ define "main" }}
  <section class="contact__section">
    <div class="container">
      <div class="row items-flex-start">
        <div class="col-12 col-lg-6">
          <div class="contact__info">
            <h1 class="contact__title text-heading-medium js-text-animation">
              {{ $title := .Title }}
              {{ with .Params.highlighted }}
                {{ $highlighted := . }}
                {{ $highlightedSpan := printf `<span class="text-gradient">%s</span>` $highlighted }}
                {{ $title = replace $title $highlighted $highlightedSpan }}
              {{ end }}
              {{ $title | safeHTML }}
            </h1>
            <p class="contact__description text-body-large js-text-animation">
              {{ .Description }}
            </p>
          </div>
        </div>
        <div class="col-12 col-lg-6">
          {{ partial "components/form.html" (dict "content" .Params.form) }}
        </div>
      </div>
    </div>
    <div class="contact__bg d-none d-lg-flex">
      <div class="left">
        {{readFile .Params.page_bg.left | safeHTML }}
      </div>
      <div class="right">
        {{readFile .Params.page_bg.right | safeHTML }}
      </div>
    </div>
  </section>
{{ end }}

{{ define "page_js" }}
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const waitForField = (selector, callback) => {
      const element = document.querySelector(selector);
      if (element) return callback(element);

      const observer = new MutationObserver((mutations, obs) => {
        const el = document.querySelector(selector);
        if (el) {
          obs.disconnect();
          callback(el);
        }
      });
      observer.observe(document.body, { childList: true, subtree: true });
    };

    waitForField("input[name='blog_source']", function (formField) {
      if (document.referrer.includes("/blog/")) {
        formField.value = document.referrer;
      }
    });
  });
</script>
{{ end }}